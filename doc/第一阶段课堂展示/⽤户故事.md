# ⽤户故事


## 用户注册及登录

---

名称：用户注册新账号

事件：

1. 用户点击首页中的注册按钮；
2. 网页进入注册界面；
3. 网页提示用户输入用于注册账号的邮箱；
4. 用户输入了注册邮箱；
5. 若邮箱未被注册过，则系统后台向用户邮箱发送6位数字验证码；若邮箱已被注册过，则弹出错误信息并提示用户用已有账号登录或重新选择新的邮箱注册；
6. 网页提示用户输入验证码；
7. 若用户输入的验证码与系统后台的验证码相匹配，则网页显示用户的邮箱并提示用户输入密码并重输确认，网页提示用户输入昵称、性别、常住城市信息；若用户输入的验证码与系统后台的验证码不匹配，则网页提示用户重新输入验证码；
8. 用户输入密码并重输确认，并输入昵称、性别、常住城市信息；
9. 用户点击注册按钮；
10. 系统后台自动为用户分配一个用户ID作为用户的唯一标识；
11. 网页进入用户信息界面，显示用户基本信息（用户昵称、用户ID、用户邮箱、常住城市）、好友列表（为空）、行迹地图（为空）以及行迹记录列表（为空）。

---

名称：用户登录账号

事件：

1. 用户点击首页中的登录按钮；
2. 网页进入登录界面；
3. 网页提示用户输入注册邮箱及密码；
4. 用户输入注册邮箱及密码；
5. 用户点击登录按钮；
6. 若用户输入的登录凭证验证通过则成功登录；若用户输入的登录凭证验证不通过，则弹出错误提示信息并要求用户重新输入注册邮箱及密码；
7. 网页进入用户信息界面，显示用户基本信息（用户昵称、用户ID、用户邮箱、常住城市）、好友列表、行迹地图（以两种不同的颜色分别在地图上标出已去过的城市以及将要去的城市）以及行迹记录列表（以时间顺序显示）。
8. 网页显示由其他用户发来的待处理消息（添加好友的确认信息、好友行迹的关联变更取消信息）

## 用户添加好友及添加好友请求确认

---

名称：用户添加好友

事件：

1. 用户点击用户信息界面中好友列表上的添加按钮；
2. 网页提示用户输入好友的用户邮箱或用户ID；
3. 用户输入好友的用户邮箱或用户ID；
4. 用户点击添加按钮；
5. 系统后台向该好友发送加好友请求信息。

---

名称：用户确认添加好友请求

事件：

1. 网页弹出添加好友请求，并显示对方的基本信息（用户昵称、用户ID、用户邮箱、性别、常住城市）；
2. 用户点击确认按钮；
3. 双方好友列表中加入对方并刷新页面。

## 用户添加行迹记录

---

名称：用户添加**已完成的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表上的添加行迹按钮；
2. 网页提示用户输入行迹城市、起止时间（**过去时**）、可见性（仅自己可见/好友可见）、备注信息；
3. 用户点击保存按钮；
4. 网页刷新并重新显示用户信息界面。

---

名称：用户添加**计划的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表上的添加行迹按钮；
2. 网页提示用户输入城市、起止时间（**将来时**，可仅精确到星期）、可见性（仅自己可见/好友可见）、备注信息；
3. 用户点击保存按钮；
4. 网页刷新并重新显示用户信息界面；
5. 网页提示好友列表中已去过该城市的好友、相同时间段将要去相近城市的好友（只在好友对该用户可见的行迹中进行查询匹配）。

## 用户向行迹记录添加和删除关联好友

---

名称：用户向**已完成的**行迹记录添加关联好友

事件：

1. 用户点击用户信息界面中行迹记录列表中**已完成的**记录边上的关联好友按钮；
2. 网页弹出消息框，显示该行迹的详细信息（城市、起止时间、可见性、备注信息）、已关联该行迹的好友列表、添加按钮、删除按钮、完成按钮；
3. 用户点击添加按钮；
4. 网页提示用户在其好友列表中选择一个好友；
5. 用户选择了一个好友；
6. 系统后台在该行迹记录中添加关联该好友；
7. 网页刷新消息框，更新已关联该行迹的好友列表；
8. 用户点击完成按钮；
9. 网页关闭该行迹的详细信息消息框。

---

名称：用户向**已完成的**行迹记录删除关联好友

事件：

1. 用户点击用户信息界面中行迹记录列表中**已完成的**记录边上的关联好友按钮；
2. 网页弹出消息框，显示该行迹的详细信息（城市、起止时间、可见性、备注信息）、已关联该行迹的好友列表、添加按钮、删除按钮、完成按钮；
3. 用户点击删除按钮；
4. 网页提示用户在已关联该行迹的好友列表中选择一个好友；
5. 用户选择了一个好友；
6. 系统后台在该行迹记录中删除关联该好友；
7. 网页刷新消息框，更新已关联该行迹的好友列表；
8. 用户点击完成按钮；
9. 网页关闭该行迹的详细信息消息框。

---

名称：用户向**计划的**行迹记录添加关联好友

事件：

1. 用户点击用户信息界面中行迹记录列表中**计划的**记录边上的关联好友按钮（要求该记录不是仅自己可见）；
2. 网页弹出消息框，显示该行迹的详细信息（城市、起止时间、可见性、备注信息）、已关联该行迹的好友列表、添加按钮、删除按钮、完成按钮；
3. 用户点击添加按钮；
4. 网页提示用户在其好友列表中选择一个好友；
5. 用户选择了一个好友；
6. 系统后台向该好友发送邀请信息（包括该用户的基本信息、该行迹的详细信息（城市、起止时间、备注信息）、已关联该行迹的共同好友列表）；
7. 网页刷新消息框，更新已关联该行迹的好友列表，新加入但还未确认的好友则显示“邀请已发送”；
8. 用户点击完成按钮；
9. 网页关闭该行迹的详细信息消息框。

---

名称：用户向**计划的**行迹记录删除关联好友

事件：

1. 用户点击用户信息界面中行迹记录列表中**计划的**记录边上的关联好友按钮**（要求该记录不是仅自己可见）**；
2. 网页弹出消息框，显示该行迹的详细信息（城市、起止时间、可见性、备注信息）、已关联该行迹的好友列表、添加按钮、删除按钮、完成按钮；
3. 用户点击删除按钮；
4. 网页提示用户在已关联该行迹的好友列表中选择一个好友；
5. 用户选择了一个好友；
6. 系统后台在该行迹记录中删除关联该好友，并向该好友发送行迹取消信息（包括该用户的基本信息、该行迹的详细信息（城市、起止时间、备注信息））；
7. 网页刷新消息框，更新已关联该行迹的好友列表；
8. 用户点击完成按钮；
9. 网页关闭该行迹的详细信息消息框。

## 用户修改行迹记录

---

名称：用户修改**已完成的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表中**已完成的**记录边上的修改按钮；
2. 网页提示用户修改行迹城市、起止时间、可见性（仅自己可见/好友可见）、备注信息；
3. 用户点击保存按钮；
4. 网页刷新并重新显示用户信息界面。

---

名称：用户修改**计划的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表中**计划的**记录边上的修改按钮；
2. 网页提示用户修改行迹城市、起止时间、可见性（仅自己可见/好友可见）、备注信息；
3. 用户点击保存按钮；
4. 网页刷新并重新显示用户信息界面；
5. 网页提示好友列表中已去过该城市的好友、相同时间段将要去相近城市的好友（只在好友对该用户可见的行迹中进行查询匹配）；
6. **若行迹可见性由好友可见变为仅自己可见**，则向所有关联该行迹的好友发送行迹取消信息（包括该用户的基本信息、该行迹的详细信息（城市、起止时间、备注信息））；**若只修改了行迹城市或时间**，则向所有关联该行迹的好友发送行迹变更信息（包括该用户的基本信息、该行迹的详细信息（城市、起止时间、备注信息））；

---

## 用户删除行迹记录

名称：用户删除**已完成的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表中**已完成的**记录边上的删除按钮；
2. 网页弹出删除提示信息，并要求用户确认；
3. 用户点击确认按钮；
4. 网页刷新并重新显示用户信息界面。

---

名称：用户删除**计划的**行迹记录

事件：

1. 用户点击用户信息界面中行迹记录列表中**计划的**记录边上的删除按钮；
2. 网页弹出删除提示信息，并要求用户确认；
3. 用户点击确认按钮；
4. 向所有关联该行迹的好友发送行迹取消信息（包括该用户的基本信息、该行迹的详细信息（城市、起止时间、备注信息））。
5. 网页刷新并重新显示用户信息界面。
